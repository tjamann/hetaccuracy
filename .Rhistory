hfx<-function(file){
filet <- file[file[,1]==0 & file[,2]==2 & file[,3]!=-1,]
dim(filet)
refAllele <- sum(filet[,3]==0)
refAllele
altAllele <- sum(filet[,3]==2)
altAllele
hetAllele <- sum(filet[,3]==1)
hetAllele
totLoci <- sum(filet[,1]==0)
totLoci
hetaccuracy <- hetAllele/totLoci
hetaccuracy*100
}
# Chunk 4
hetfiles <- list(samBC, samBM, gatBC, gatBM)
result <- lapply(hetfiles, hfx)
hetfilenames <- list("samBC", "samBM", "gatBC", "gatBM")
results <- as.data.frame(cbind(hetfilenames, result))
results$result <- as.numeric(results$result)
# Chunk 5
samavg <- (results[1,2]+results[2,2])/2
samavg
gatavg <- (results[3,2]+results[4,2])/2
gatavg
# Chunk 6
falsepositives <- function(file){
file2 <- file[file[,1]!=-1 & file[,2]!=-1 & file[,3]==1,]
dim(file2)
totLoci <- sum(file2[,3]==1)
totLoci
correctcalls <- sum(file2[,1]==0 & file2[,2]==2)
correctcalls
accuracy <- correctcalls/totLoci
accuracy*100
}
# Chunk 7
resultsfalsepos <- lapply(hetfiles, falsepositives)
hetfilenames <- list("samBC", "samBM", "gatBC", "gatBM")
resultsfalsepos <- as.data.frame(cbind(hetfilenames, result, resultsfalsepos))
resultsfalsepos$result <- as.numeric(results$result)
resultsfalsepos$resultsfalsepos <- as.numeric(resultsfalsepos$resultsfalsepos)
resultsfalsepos$hetfilenames <- as.character(resultsfalsepos$hetfilenames)
resultsfalsepos
write.csv(resultsfalsepos, file="hetaccuracies.csv")
# Chunk 8
samavgfalsepos <- (resultsfalsepos[1,3]+resultsfalsepos[2,3])/2
samavgfalsepos
gatavgfalsepos <- (resultsfalsepos[3,3]+resultsfalsepos[4,3])/2
gatavgfalsepos
sam <- list(samavg, samavgfalsepos)
sam
tool <- list("samavg", "gatavg")
correcthet <- list(samavg, gatavg)
correctparents <- list(samavgfalsepos, gatavgfalsepos)
tool <- list("samavg", "gatavg")
correcthet <- list(samavg, gatavg)
correctparents <- list(samavgfalsepos, gatavgfalsepos)
averages <- as.data.frame(cbind(tool, correcthet, correctparents))
averages$correcthet <- as.numeric(averages$correcthet)
averages$correctparents <- as.numeric(averages$correctparents)
averages$tool <- as.character(averages$tool)
averages
str(averages)
# Chunk 1
genos <- read.delim("out.012", header=FALSE)
indiv <- read.table("out.012.indv", quote="\"", comment.char="")
genos$V1 <- NULL
gi <- cbind(indiv, genos)
row.names(gi) <- gi$V1
gi=gi[,-1]
tgi <- as.data.frame(t(gi))
# Chunk 2
samBC <- tgi[ ,1:3]
samBM <- tgi[ ,4:6]
gatBC <- tgi[ ,7:9]
gatBM <- tgi[ ,10:12]
# Chunk 3
hfx<-function(file){
filet <- file[file[,1]==0 & file[,2]==2 & file[,3]!=-1,]
dim(filet)
refAllele <- sum(filet[,3]==0)
refAllele
altAllele <- sum(filet[,3]==2)
altAllele
hetAllele <- sum(filet[,3]==1)
hetAllele
totLoci <- sum(filet[,1]==0)
totLoci
hetaccuracy <- hetAllele/totLoci
hetaccuracy*100
}
# Chunk 4
hetfiles <- list(samBC, samBM, gatBC, gatBM)
result <- lapply(hetfiles, hfx)
hetfilenames <- list("samBC", "samBM", "gatBC", "gatBM")
results <- as.data.frame(cbind(hetfilenames, result))
results$result <- as.numeric(results$result)
# Chunk 5
falsepositives <- function(file){
file2 <- file[file[,1]!=-1 & file[,2]!=-1 & file[,3]==1,]
dim(file2)
totLoci <- sum(file2[,3]==1)
totLoci
correctcalls <- sum(file2[,1]==0 & file2[,2]==2)
correctcalls
accuracy <- correctcalls/totLoci
accuracy*100
}
# Chunk 6
resultsfalsepos <- lapply(hetfiles, falsepositives)
hetfilenames <- list("samBC", "samBM", "gatBC", "gatBM")
resultsfalsepos <- as.data.frame(cbind(hetfilenames, result, resultsfalsepos))
resultsfalsepos$result <- as.numeric(results$result)
resultsfalsepos$resultsfalsepos <- as.numeric(resultsfalsepos$resultsfalsepos)
resultsfalsepos$hetfilenames <- as.character(resultsfalsepos$hetfilenames)
resultsfalsepos
write.csv(resultsfalsepos, file="hetaccuracies.csv")
# Chunk 7
samavg <- (results[1,2]+results[2,2])/2
gatavg <- (results[3,2]+results[4,2])/2
samavgfalsepos <- (resultsfalsepos[1,3]+resultsfalsepos[2,3])/2
gatavgfalsepos <- (resultsfalsepos[3,3]+resultsfalsepos[4,3])/2
# Chunk 8
tool <- list("samavg", "gatavg")
correcthet <- list(samavg, gatavg)
correctparents <- list(samavgfalsepos, gatavgfalsepos)
averages <- as.data.frame(cbind(tool, correcthet, correctparents))
averages$correcthet <- as.numeric(averages$correcthet)
averages$correctparents <- as.numeric(averages$correctparents)
averages$tool <- as.character(averages$tool)
averages
write.csv(averages, file="hetaccuraciesaverages.csv")
# Chunk 1
genos <- read.delim("out.012", header=FALSE)
indiv <- read.table("out.012.indv", quote="\"", comment.char="")
genos$V1 <- NULL
gi <- cbind(indiv, genos)
row.names(gi) <- gi$V1
gi=gi[,-1]
tgi <- as.data.frame(t(gi))
# Chunk 2
samBC <- tgi[ ,1:3]
samBM <- tgi[ ,4:6]
gatBC <- tgi[ ,7:9]
gatBM <- tgi[ ,10:12]
# Chunk 3
hfx<-function(file){
filet <- file[file[,1]==0 & file[,2]==2 & file[,3]!=-1,]
dim(filet)
refAllele <- sum(filet[,3]==0)
refAllele
altAllele <- sum(filet[,3]==2)
altAllele
hetAllele <- sum(filet[,3]==1)
hetAllele
totLoci <- sum(filet[,1]==0)
totLoci
hetaccuracy <- hetAllele/totLoci
hetaccuracy*100
}
# Chunk 4
hetfiles <- list(samBC, samBM, gatBC, gatBM)
result <- lapply(hetfiles, hfx)
hetfilenames <- list("samBC", "samBM", "gatBC", "gatBM")
results <- as.data.frame(cbind(hetfilenames, result))
results$result <- as.numeric(results$result)
# Chunk 5
falsepositives <- function(file){
file2 <- file[file[,1]!=-1 & file[,2]!=-1 & file[,3]==1,]
dim(file2)
totLoci <- sum(file2[,3]==1)
totLoci
correctcalls <- sum(file2[,1]==0 & file2[,2]==2)
correctcalls
accuracy <- correctcalls/totLoci
accuracy*100
}
# Chunk 6
resultsfalsepos <- lapply(hetfiles, falsepositives)
hetfilenames <- list("samBC", "samBM", "gatBC", "gatBM")
resultsfalsepos <- as.data.frame(cbind(hetfilenames, result, resultsfalsepos))
resultsfalsepos$correcthybrid <- as.numeric(results$result)
resultsfalsepos$correctparents <- as.numeric(resultsfalsepos$resultsfalsepos)
resultsfalsepos$hetfilenames <- as.character(resultsfalsepos$hetfilenames)
resultsfalsepos
write.csv(resultsfalsepos, file="hetaccuracies.csv")
# Chunk 7
samavg <- (results[1,2]+results[2,2])/2
gatavg <- (results[3,2]+results[4,2])/2
samavgfalsepos <- (resultsfalsepos[1,3]+resultsfalsepos[2,3])/2
gatavgfalsepos <- (resultsfalsepos[3,3]+resultsfalsepos[4,3])/2
# Chunk 8
tool <- list("samavg", "gatavg")
correcthet <- list(samavg, gatavg)
correctparents <- list(samavgfalsepos, gatavgfalsepos)
averages <- as.data.frame(cbind(tool, correcthet, correctparents))
averages$correcthybrid <- as.numeric(averages$correcthet)
averages$correctparents <- as.numeric(averages$correctparents)
averages$tool <- as.character(averages$tool)
averages
write.csv(averages, file="hetaccuraciesaverages.csv")
resultsfalsepos
correctparents <- lapply(hetfiles, falsepositives)
hetfilenames <- list("samBC", "samBM", "gatBC", "gatBM")
correctparents <- as.data.frame(cbind(hetfilenames, result, correctparents))
correctparents$correcthybrid <- as.numeric(results$result)
correctparents$correctparents <- as.numeric(correctparents$correctparents)
correctparents$hetfilenames <- as.character(correctparents$hetfilenames)
correctparents
write.csv(correctparents, file="hetaccuracies.csv")
# Chunk 1
genos <- read.delim("out.012", header=FALSE)
indiv <- read.table("out.012.indv", quote="\"", comment.char="")
genos$V1 <- NULL
gi <- cbind(indiv, genos)
row.names(gi) <- gi$V1
gi=gi[,-1]
tgi <- as.data.frame(t(gi))
# Chunk 2
samBC <- tgi[ ,1:3]
samBM <- tgi[ ,4:6]
gatBC <- tgi[ ,7:9]
gatBM <- tgi[ ,10:12]
# Chunk 3
hfx<-function(file){
filet <- file[file[,1]==0 & file[,2]==2 & file[,3]!=-1,]
dim(filet)
refAllele <- sum(filet[,3]==0)
refAllele
altAllele <- sum(filet[,3]==2)
altAllele
hetAllele <- sum(filet[,3]==1)
hetAllele
totLoci <- sum(filet[,1]==0)
totLoci
hetaccuracy <- hetAllele/totLoci
hetaccuracy*100
}
# Chunk 4
hetfiles <- list(samBC, samBM, gatBC, gatBM)
result <- lapply(hetfiles, hfx)
hetfilenames <- list("samBC", "samBM", "gatBC", "gatBM")
correcthybrid <- as.data.frame(cbind(hetfilenames, result))
correcthybrid$result <- as.numeric(correcthybrid$result)
# Chunk 5
falsepositives <- function(file){
file2 <- file[file[,1]!=-1 & file[,2]!=-1 & file[,3]==1,]
dim(file2)
totLoci <- sum(file2[,3]==1)
totLoci
correctcalls <- sum(file2[,1]==0 & file2[,2]==2)
correctcalls
accuracy <- correctcalls/totLoci
accuracy*100
}
# Chunk 6
correctparents <- lapply(hetfiles, falsepositives)
hetfilenames <- list("samBC", "samBM", "gatBC", "gatBM")
correctparents <- as.data.frame(cbind(hetfilenames, result, correctparents))
correctparents$correcthybrid <- as.numeric(correcthybrid$result)
correctparents$correctparents <- as.numeric(correctparents$correctparents)
correctparents$hetfilenames <- as.character(correctparents$hetfilenames)
correctparents
write.csv(correctparents, file="hetaccuracies.csv")
# Chunk 7
samavg <- (correcthybrid[1,2]+correcthybrid[2,2])/2
gatavg <- (correcthybrid[3,2]+correcthybrid[4,2])/2
samavgfalsepos <- (correctparents[1,3]+correctparents[2,3])/2
gatavgfalsepos <- (correctparents[3,3]+correctparents[4,3])/2
# Chunk 8
tool <- list("samavg", "gatavg")
correcthet <- list(samavg, gatavg)
correctparents <- list(samavgfalsepos, gatavgfalsepos)
averages <- as.data.frame(cbind(tool, correcthet, correctparents))
averages$correcthybrid <- as.numeric(averages$correcthybrid)
averages$correctparents <- as.numeric(averages$correctparents)
averages$tool <- as.character(averages$tool)
averages
write.csv(averages, file="hetaccuraciesaverages.csv")
str(correctparents)
# Chunk 1
genos <- read.delim("out.012", header=FALSE)
indiv <- read.table("out.012.indv", quote="\"", comment.char="")
genos$V1 <- NULL
gi <- cbind(indiv, genos)
row.names(gi) <- gi$V1
gi=gi[,-1]
tgi <- as.data.frame(t(gi))
# Chunk 2
samBC <- tgi[ ,1:3]
samBM <- tgi[ ,4:6]
gatBC <- tgi[ ,7:9]
gatBM <- tgi[ ,10:12]
# Chunk 3
hfx<-function(file){
filet <- file[file[,1]==0 & file[,2]==2 & file[,3]!=-1,]
dim(filet)
refAllele <- sum(filet[,3]==0)
refAllele
altAllele <- sum(filet[,3]==2)
altAllele
hetAllele <- sum(filet[,3]==1)
hetAllele
totLoci <- sum(filet[,1]==0)
totLoci
hetaccuracy <- hetAllele/totLoci
hetaccuracy*100
}
# Chunk 4
hetfiles <- list(samBC, samBM, gatBC, gatBM)
resultcorrecthybrid <- lapply(hetfiles, hfx)
hetfilenames <- list("samBC", "samBM", "gatBC", "gatBM")
correcthybrid <- as.data.frame(cbind(hetfilenames, resultcorrecthybrid))
correcthybrid$resultcorrecthybrid <- as.numeric(correcthybrid$resultcorrecthybrid)
# Chunk 5
correctparentfx <- function(file){
file2 <- file[file[,1]!=-1 & file[,2]!=-1 & file[,3]==1,]
dim(file2)
totLoci <- sum(file2[,3]==1)
totLoci
correctcalls <- sum(file2[,1]==0 & file2[,2]==2)
correctcalls
accuracy <- correctcalls/totLoci
accuracy*100
}
# Chunk 6
resultcorrectparents <- lapply(hetfiles, correctparentfx)
hetfilenames <- list("samBC", "samBM", "gatBC", "gatBM")
hetaccuracy <- as.data.frame(cbind(hetfilenames, resultcorrecthybrid, resultcorrectparents))
hetaccuracy$resultcorrecthybrid <- as.numeric(hetaccuracy$resultcorrecthybrid)
hetaccuracy$resultcorrectparents <- as.numeric(hetaccuracy$resultcorrectparents)
hetaccuracy$hetfilenames <- as.character(hetaccuracy$hetfilenames)
hetaccuracy
write.csv(hetaccuracy, file="hetaccuracies.csv")
# Chunk 7
samavg <- (correcthybrid[1,2]+correcthybrid[2,2])/2
gatavg <- (correcthybrid[3,2]+correcthybrid[4,2])/2
samavgfalsepos <- (correctparents[1,3]+correctparents[2,3])/2
gatavgfalsepos <- (correctparents[3,3]+correctparents[4,3])/2
# Chunk 8
tool <- list("samavg", "gatavg")
correcthet <- list(samavg, gatavg)
correctparents <- list(samavgfalsepos, gatavgfalsepos)
averages <- as.data.frame(cbind(tool, correcthet, correctparents))
averages$correcthybrid <- as.numeric(averages$correcthybrid)
averages$correctparents <- as.numeric(averages$correctparents)
averages$tool <- as.character(averages$tool)
averages
write.csv(averages, file="hetaccuraciesaverages.csv")
# Chunk 1
genos <- read.delim("out.012", header=FALSE)
indiv <- read.table("out.012.indv", quote="\"", comment.char="")
genos$V1 <- NULL
gi <- cbind(indiv, genos)
row.names(gi) <- gi$V1
gi=gi[,-1]
tgi <- as.data.frame(t(gi))
# Chunk 2
samBC <- tgi[ ,1:3]
samBM <- tgi[ ,4:6]
gatBC <- tgi[ ,7:9]
gatBM <- tgi[ ,10:12]
# Chunk 3
hfx<-function(file){
filet <- file[file[,1]==0 & file[,2]==2 & file[,3]!=-1,]
dim(filet)
refAllele <- sum(filet[,3]==0)
refAllele
altAllele <- sum(filet[,3]==2)
altAllele
hetAllele <- sum(filet[,3]==1)
hetAllele
totLoci <- sum(filet[,1]==0)
totLoci
hetaccuracy <- hetAllele/totLoci
hetaccuracy*100
}
# Chunk 4
hetfiles <- list(samBC, samBM, gatBC, gatBM)
resultcorrecthybrid <- lapply(hetfiles, hfx)
#hetfilenames <- list("samBC", "samBM", "gatBC", "gatBM")
#correcthybrid <- as.data.frame(cbind(hetfilenames, resultcorrecthybrid))
#correcthybrid$resultcorrecthybrid <- as.numeric(correcthybrid$resultcorrecthybrid)
# Chunk 5
correctparentfx <- function(file){
file2 <- file[file[,1]!=-1 & file[,2]!=-1 & file[,3]==1,]
dim(file2)
totLoci <- sum(file2[,3]==1)
totLoci
correctcalls <- sum(file2[,1]==0 & file2[,2]==2)
correctcalls
accuracy <- correctcalls/totLoci
accuracy*100
}
# Chunk 6
resultcorrectparents <- lapply(hetfiles, correctparentfx)
hetfilenames <- list("samBC", "samBM", "gatBC", "gatBM")
hetaccuracy <- as.data.frame(cbind(hetfilenames, resultcorrecthybrid, resultcorrectparents))
hetaccuracy$resultcorrecthybrid <- as.numeric(hetaccuracy$resultcorrecthybrid)
hetaccuracy$resultcorrectparents <- as.numeric(hetaccuracy$resultcorrectparents)
hetaccuracy$hetfilenames <- as.character(hetaccuracy$hetfilenames)
hetaccuracy
write.csv(hetaccuracy, file="hetaccuracies.csv")
# Chunk 7
samavghyb <- (hetaccuracy[1,2]+hetaccuracy[2,2])/2
gatavghyb <- (hetaccuracy[3,2]+hetaccuracy[4,2])/2
samavgpar <- (hetaccuracy[1,3]+hetaccuracy[2,3])/2
gatavgpar <- (hetaccuracy[3,3]+hetaccuracy[4,3])/2
# Chunk 8
tool <- list("samavg", "gatavg")
correcthet <- list(samavg, gatavg)
correctparents <- list(samavgfalsepos, gatavgfalsepos)
averages <- as.data.frame(cbind(tool, correcthet, correctparents))
averages$correcthybrid <- as.numeric(averages$correcthybrid)
averages$correctparents <- as.numeric(averages$correctparents)
averages$tool <- as.character(averages$tool)
averages
write.csv(averages, file="hetaccuraciesaverages.csv")
samavghyb <- (hetaccuracy[1,2]+hetaccuracy[2,2])/2
gatavghyb <- (hetaccuracy[3,2]+hetaccuracy[4,2])/2
samavgpar <- (hetaccuracy[1,3]+hetaccuracy[2,3])/2
gatavgpar <- (hetaccuracy[3,3]+hetaccuracy[4,3])/2
tool <- list("samavg", "gatavg")
correcthyb <- list(samavghyb, gatavghyb)
correctpar <- list(samavgpar, samavgpar)
averages <- as.data.frame(cbind(tool, correcthyb, correctpar))
averages$correcthyb <- as.numeric(averages$correcthyb)
averages$correctpar <- as.numeric(averages$correctpar)
averages$tool <- as.character(averages$tool)
averages
gatavghyb <- (hetaccuracy[3,2]+hetaccuracy[4,2])/2
gatavghyb
gatavgpar <- (hetaccuracy[3,3]+hetaccuracy[4,3])/2
tool <- list("samavg", "gatavg")
correcthyb <- list(samavghyb, gatavghyb)
correctpar <- list(samavgpar, gatavgpar)
averages <- as.data.frame(cbind(tool, correcthyb, correctpar))
averages$correcthyb <- as.numeric(averages$correcthyb)
averages$correctpar <- as.numeric(averages$correctpar)
averages$tool <- as.character(averages$tool)
averages
# Chunk 1
genos <- read.delim("out.012", header=FALSE)
indiv <- read.table("out.012.indv", quote="\"", comment.char="")
genos$V1 <- NULL
gi <- cbind(indiv, genos)
row.names(gi) <- gi$V1
gi=gi[,-1]
tgi <- as.data.frame(t(gi))
# Chunk 2
samBC <- tgi[ ,1:3]
samBM <- tgi[ ,4:6]
gatBC <- tgi[ ,7:9]
gatBM <- tgi[ ,10:12]
# Chunk 3
hfx<-function(file){
filet <- file[file[,1]==0 & file[,2]==2 & file[,3]!=-1,]
dim(filet)
refAllele <- sum(filet[,3]==0)
refAllele
altAllele <- sum(filet[,3]==2)
altAllele
hetAllele <- sum(filet[,3]==1)
hetAllele
totLoci <- sum(filet[,1]==0)
totLoci
hetaccuracy <- hetAllele/totLoci
hetaccuracy*100
}
# Chunk 4
hetfiles <- list(samBC, samBM, gatBC, gatBM)
resultcorrecthybrid <- lapply(hetfiles, hfx)
#hetfilenames <- list("samBC", "samBM", "gatBC", "gatBM")
#correcthybrid <- as.data.frame(cbind(hetfilenames, resultcorrecthybrid))
#correcthybrid$resultcorrecthybrid <- as.numeric(correcthybrid$resultcorrecthybrid)
# Chunk 5
correctparentfx <- function(file){
file2 <- file[file[,1]!=-1 & file[,2]!=-1 & file[,3]==1,]
dim(file2)
totLoci <- sum(file2[,3]==1)
totLoci
correctcalls <- sum(file2[,1]==0 & file2[,2]==2)
correctcalls
accuracy <- correctcalls/totLoci
accuracy*100
}
# Chunk 6
resultcorrectparents <- lapply(hetfiles, correctparentfx)
hetfilenames <- list("samBC", "samBM", "gatBC", "gatBM")
hetaccuracy <- as.data.frame(cbind(hetfilenames, resultcorrecthybrid, resultcorrectparents))
hetaccuracy$resultcorrecthybrid <- as.numeric(hetaccuracy$resultcorrecthybrid)
hetaccuracy$resultcorrectparents <- as.numeric(hetaccuracy$resultcorrectparents)
hetaccuracy$hetfilenames <- as.character(hetaccuracy$hetfilenames)
hetaccuracy
write.csv(hetaccuracy, file="hetaccuracies.csv")
# Chunk 7
samavghyb <- (hetaccuracy[1,2]+hetaccuracy[2,2])/2
gatavghyb <- (hetaccuracy[3,2]+hetaccuracy[4,2])/2
samavgpar <- (hetaccuracy[1,3]+hetaccuracy[2,3])/2
gatavgpar <- (hetaccuracy[3,3]+hetaccuracy[4,3])/2
# Chunk 8
tool <- list("samavg", "gatavg")
correcthyb <- list(samavghyb, gatavghyb)
correctpar <- list(samavgpar, gatavgpar)
averages <- as.data.frame(cbind(tool, correcthyb, correctpar))
averages$correcthyb <- as.numeric(averages$correcthyb)
averages$correctpar <- as.numeric(averages$correctpar)
averages$tool <- as.character(averages$tool)
averages
write.csv(averages, file="hetaccuraciesaverages.csv")
setwd("~/Google Drive/final_analysis_LRS/pilot_22Apr2016_final/workdir")
